<!DOCTYPE html>
<!-- saved from url=(0035)http://localhost:8081/summary/pages -->
<html lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Assistant Lite - AI Book Analysis</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
    <link href="./Book Assistant Lite - AI Book Analysis_files/css2" rel="stylesheet">
    
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet" href="./Book Assistant Lite - AI Book Analysis_files/atom-one-dark.min.css">
    
    <link rel="stylesheet" href="./Book Assistant Lite - AI Book Analysis_files/f.txt">
<style>/* red-hat-display-latin-ext-400-normal */
@font-face {
  font-family: 'Red Hat Display';
  font-style: normal;
  font-display: swap;
  font-weight: 400;
  src: url(assets/red-hat-display-latin-ext-400-normal.woff2) format('woff2'), url(assets/red-hat-display-latin-ext-400-normal.woff) format('woff');
  unicode-range: U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;
}

/* red-hat-display-latin-400-normal */
@font-face {
  font-family: 'Red Hat Display';
  font-style: normal;
  font-display: swap;
  font-weight: 400;
  src: url(assets/red-hat-display-latin-400-normal.woff2) format('woff2'), url(assets/red-hat-display-latin-400-normal.woff) format('woff');
  unicode-range: U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;
}</style><style>.copilot-toast-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:rgba(0, 0, 0, 0.7);z-index:99998}.copilot-toast{position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);background:#fff;padding:24px;width:640px;max-width:95%;border-radius:24px;box-shadow:0 8px 24px rgba(0, 0, 0, 0.2);z-index:99999;font-family:"Red Hat Display",sans-serif}.copilot-toast-wrapper{display:flex;align-items:center;justify-content:space-between;gap:20px;flex-wrap:wrap}.copilot-toast-left{flex:1 1 50%}.copilot-toast-heading{font-size:20px;margin-bottom:40px;font-weight:bold}.copilot-toast-para{font-size:14px;margin-bottom:10px;color:#444}.copilot-toast-title{font-size:18px;font-weight:600;margin-bottom:10px}.copilot-toast-image{width:180px;height:auto;border-radius:8px;flex:1 1 40%}.copilot-toast-button{background-color:#4314b6;color:#fff;border:none;padding:10px 20px;border-radius:6px;font-size:14px;margin-top:20px;cursor:pointer;display:block;margin-left:auto;margin-right:auto}.copilot-toast-button:hover{background-color:#8a61ee}.jc-loading-wrapper{position:fixed;top:0;right:0;width:50vw;height:100vh;background:#fff;border-left:1px solid #ddd;z-index:999999999;display:flex;align-items:center;justify-content:center}.jc-loading-title{font-size:26px;font-weight:600;margin-bottom:30px}.jc-spinner{width:70px;height:70px;border:8px solid #e4dfff;border-top-color:#8a61ee;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:25px}@keyframes spin{to{transform:rotate(360deg)}}.jc-loading-steps{font-size:16px;color:#666;text-align:center;line-height:1.6}</style><style>@font-face{font-family:"Red Hat Display";font-style:normal;font-display:swap;font-weight:300;src:url(assets/red-hat-display-latin-ext-300-normal.woff2) format("woff2"),url(assets/red-hat-display-latin-ext-300-normal.woff) format("woff");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:"Red Hat Display";font-style:normal;font-display:swap;font-weight:300;src:url(assets/red-hat-display-latin-300-normal.woff2) format("woff2"),url(assets/red-hat-display-latin-300-normal.woff) format("woff");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style>@font-face{font-family:"Red Hat Display";font-style:normal;font-display:swap;font-weight:400;src:url(assets/red-hat-display-latin-ext-400-normal.woff2) format("woff2"),url(assets/red-hat-display-latin-ext-400-normal.woff) format("woff");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:"Red Hat Display";font-style:normal;font-display:swap;font-weight:400;src:url(assets/red-hat-display-latin-400-normal.woff2) format("woff2"),url(assets/red-hat-display-latin-400-normal.woff) format("woff");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style>@font-face{font-family:"Red Hat Display";font-style:normal;font-display:swap;font-weight:500;src:url(assets/red-hat-display-latin-ext-500-normal.woff2) format("woff2"),url(assets/red-hat-display-latin-ext-500-normal.woff) format("woff");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:"Red Hat Display";font-style:normal;font-display:swap;font-weight:500;src:url(assets/red-hat-display-latin-500-normal.woff2) format("woff2"),url(assets/red-hat-display-latin-500-normal.woff) format("woff");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style>@font-face{font-family:"Red Hat Display";font-style:normal;font-display:swap;font-weight:600;src:url(assets/red-hat-display-latin-ext-600-normal.woff2) format("woff2"),url(assets/red-hat-display-latin-ext-600-normal.woff) format("woff");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:"Red Hat Display";font-style:normal;font-display:swap;font-weight:600;src:url(assets/red-hat-display-latin-600-normal.woff2) format("woff2"),url(assets/red-hat-display-latin-600-normal.woff) format("woff");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style>@font-face{font-family:"Red Hat Display";font-style:normal;font-display:swap;font-weight:700;src:url(assets/red-hat-display-latin-ext-700-normal.woff2) format("woff2"),url(assets/red-hat-display-latin-ext-700-normal.woff) format("woff");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:"Red Hat Display";font-style:normal;font-display:swap;font-weight:700;src:url(assets/red-hat-display-latin-700-normal.woff2) format("woff2"),url(assets/red-hat-display-latin-700-normal.woff) format("woff");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">üìö</span>
                    <h1>Book Assistant Lite</h1>
                </div>
                <div class="book-status">
                    <span class="status-dot"></span>
                    <span class="status-text">English Book Loaded</span>
                    <span class="lang-badge">English</span>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Upload Section -->
        <section class="upload-section card has-book">
            <div class="upload-header">
                <h2>
                    <span class="icon">üì§</span>
                    <span>Book Loaded</span>
                </h2>
                <p class="subtitle">You can now use analysis tools</p>
            </div>

            <form action="http://localhost:8081/upload" method="post" enctype="multipart/form-data" class="upload-form">
                <div class="drop-zone" id="dropZone">
                    <input type="file" name="file" accept="application/pdf" id="fileInput" required="">
                    <div class="drop-zone-content">
                        <div class="drop-icon">üìÑ</div>
                        <p class="drop-text">Click to change file</p>
                        <p class="drop-subtext">PDF ÿ≠ÿ™Ÿâ 200MB</p>
                        <div class="file-info">
                            <span class="file-icon">‚úÖ</span>
                            <span>Language detected: English</span>
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">Re-upload</button>
            </form>

            

            
        </section>

        <!-- Language Settings - Only shown when book is loaded -->
        <section class="lang-section card">
            <div class="lang-header">
                <h3>
                    <span class="icon">üåê</span>
                    <span>Language Settings</span>
                </h3>
            </div>
            <div class="lang-controls">
                <div class="lang-option">
                    <label>Detected Book Language</label>
                    <span class="lang-badge">English</span>
                </div>
                <div class="lang-option">
                    <label>Output Language</label>
                    <select name="outputLanguage" id="outputLanguage" class="lang-select">
                        <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                        <option value="en" selected="selected">English</option>
                    </select>
                </div>
            </div>
        </section>

        <!-- Analysis Tools Accordion - Only shown when book is loaded -->
        <div class="accordion-container">
            
            <!-- Group 1: Summary -->
            <div class="accordion-group active" data-group="summary">
                <div class="accordion-header" onclick="toggleAccordion(&#39;summary&#39;)">
                    <div class="accordion-title">
                        <span class="accordion-icon">üìñ</span>
                        <h3>Summaries</h3>
                    </div>
                    <span class="accordion-arrow" id="arrow-summary" style="transform: rotate(180deg);">‚ñº</span>
                </div>
                <div class="accordion-content active" id="content-summary">
                    <!-- General Summary -->
                    <div class="tool-card">
                        <div class="tool-header">
                            <h4>üìñ <span>General Summary</span></h4>
                        </div>
                        <form action="http://localhost:8081/summary/general" method="post" onsubmit="handleSubmit(this, &#39;summaryGeneral&#39;)">
                            <button type="submit" class="btn btn-tool">
                                <span>Generate Summary</span>
                            </button>
                        </form>
                        <div class="result-container" id="result-summaryGeneral">
                            
                            <p class="no-result">Click button to generate summary</p>
                        </div>
                    </div>

                    <!-- Pages Summary -->
                    <div class="tool-card">
                        <div class="tool-header">
                            <h4>üìÑ <span>Selected Pages Summary</span></h4>
                        </div>
                        <form action="http://localhost:8081/summary/pages" method="post" onsubmit="handleSubmit(this, &#39;summaryPages&#39;)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From Page</label>
                                    <input type="number" name="startPage" min="1" required="">
                                </div>
                                <div class="form-group">
                                    <label>To Page</label>
                                    <input type="number" name="endPage" min="1" required="">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-tool">
                                <span>Summarize</span></button>
                        </form>
                        <div class="result-container" id="result-summaryPages">
                            <div class="chat-message">
                                <div class="message-content markdown-body" data-content="## Chapter 3: The Spring Context - Wiring Beans

This chapter focuses on **establishing relationships between beans** in the Spring context using **dependency injection (DI)**.

### Key Concepts:

**Wiring Approaches:**
1. **Direct Method Calling** - Call one `@Bean` method directly from another to establish relationships
2. **Auto-wiring via Parameters** - Use method parameters to let Spring automatically provide bean dependencies
3. **@Autowired Annotation** - Mark fields, constructors, or setters for automatic injection

**@Autowired Usage Patterns:**
- **Field injection** - Simple but not recommended for production (can&#39;t use `final`)
- **Constructor injection** - Most common in production code (allows `final` fields)
- **Setter injection** - Rarely used due to limitations

**Important Scenarios:**

**Circular Dependencies** - Occur when two beans depend on each other, causing Spring to fail with a `BeanCurrentlyInCreationException`. Should be avoided through proper design.

**Multiple Bean Selection** - When multiple beans of the same type exist:
- Match parameter names to bean names
- Use `@Qualifier(&quot;beanName&quot;)` for explicit selection  
- Use `@Primary` to mark default beans

### Core Takeaway:
Dependency Injection is fundamental to Spring applications - it allows objects to reference each other automatically while maintaining loose coupling and testability. Understanding these wiring techniques is essential for building robust Spring applications."></div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>

            <!-- Group 2: Analysis -->
            <div class="accordion-group" data-group="analysis">
                <div class="accordion-header" onclick="toggleAccordion(&#39;analysis&#39;)">
                    <div class="accordion-title">
                        <span class="accordion-icon">üî¨</span>
                        <h3>Analysis</h3>
                    </div>
                    <span class="accordion-arrow" id="arrow-analysis">‚ñº</span>
                </div>
                <div class="accordion-content" id="content-analysis">
                    <!-- Reality Check -->
                    <div class="tool-card">
                        <div class="tool-header">
                            <h4>‚úÖ <span>Reality Check</span></h4>
                        </div>
                        <form action="http://localhost:8081/reality-check" method="post" onsubmit="handleSubmit(this, &#39;realityCheck&#39;)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From Page</label>
                                    <input type="number" name="startPage" min="1" required="">
                                </div>
                                <div class="form-group">
                                    <label>To Page</label>
                                    <input type="number" name="endPage" min="1" required="">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-tool">
                                <span>Check</span>
                            </button>
                        </form>
                        <div class="result-container" id="result-realityCheck">
                            
                            <p class="no-result">Enter page range and click Check</p>
                        </div>
                    </div>

                    <!-- Concept Map -->
                    <div class="tool-card">
                        <div class="tool-header">
                            <h4>üó∫Ô∏è <span>Concept Map</span></h4>
                        </div>
                        <form action="http://localhost:8081/concept-map" method="post" onsubmit="handleSubmit(this, &#39;conceptMap&#39;)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From Page</label>
                                    <input type="number" name="startPage" min="1" required="">
                                </div>
                                <div class="form-group">
                                    <label>To Page</label>
                                    <input type="number" name="endPage" min="1" required="">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-tool">
                                <span>Generate Map</span>
                            </button>
                        </form>
                        <div class="result-container" id="result-conceptMap">
                            
                            <p class="no-result">Enter page range and click Generate Map</p>
                        </div>
                    </div>

                    <!-- Risk Flags -->
                    <div class="tool-card">
                        <div class="tool-header">
                            <h4>‚ö†Ô∏è <span>Risk Flags</span></h4>
                        </div>
                        <form action="http://localhost:8081/risk-flags" method="post" onsubmit="handleSubmit(this, &#39;riskFlags&#39;)">
                            <button type="submit" class="btn btn-tool">
                                <span>Extract Flags</span>
                            </button>
                        </form>
                        <div class="result-container" id="result-riskFlags">
                            
                            <p class="no-result">Click to extract risk flags</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Group 3: Interactive -->
            <div class="accordion-group" data-group="interactive">
                <div class="accordion-header" onclick="toggleAccordion(&#39;interactive&#39;)">
                    <div class="accordion-title">
                        <span class="accordion-icon">üí¨</span>
                        <h3>Interactive</h3>
                    </div>
                    <span class="accordion-arrow" id="arrow-interactive">‚ñº</span>
                </div>
                <div class="accordion-content" id="content-interactive">
                    <!-- Action Plan -->
                    <div class="tool-card">
                        <div class="tool-header">
                            <h4>üìã <span>Action Plan</span></h4>
                        </div>
                        <form action="http://localhost:8081/action-plan" method="post" onsubmit="handleSubmit(this, &#39;actionPlan&#39;)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From Page</label>
                                    <input type="number" name="startPage" min="1" required="">
                                </div>
                                <div class="form-group">
                                    <label>To Page</label>
                                    <input type="number" name="endPage" min="1" required="">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-tool">
                                <span>Generate Plan</span>
                            </button>
                        </form>
                        <div class="result-container" id="result-actionPlan">
                            
                            <p class="no-result">Enter page range and click Generate Plan</p>
                        </div>
                    </div>

                    <!-- Semantic Search -->
                    <div class="tool-card">
                        <div class="tool-header">
                            <h4>üîç <span>Semantic Search</span></h4>
                        </div>
                        <form action="http://localhost:8081/semantic-search" method="post" onsubmit="handleSubmit(this, &#39;semanticSearch&#39;)">
                            <div class="form-row">
                                <div class="form-group form-group-full">
                                    <label>What are you looking for?</label>
                                    <input type="text" name="query" required="" placeholder="Type your search...">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-tool">
                                <span>Search</span>
                            </button>
                        </form>
                        <div class="result-container" id="result-semanticSearch">
                            
                            <p class="no-result">Type your query and click Search</p>
                        </div>
                    </div>

                    <!-- Q&A -->
                    <div class="tool-card">
                        <div class="tool-header">
                            <h4>‚ùì <span>Question &amp; Answer</span></h4>
                        </div>
                        <form action="http://localhost:8081/qa" method="post" onsubmit="handleSubmit(this, &#39;qa&#39;)">
                            <div class="form-row">
                                <div class="form-group form-group-full">
                                    <label>Ask about the book</label>
                                    <input type="text" name="question" required="" placeholder="Type your question...">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-tool">
                                <span>Send</span>
                            </button>
                        </form>
                        <div class="result-container" id="result-qa">
                            
                            <p class="no-result">Type your question and click Send</p>
                        </div>
                    </div>

                    <!-- Comprehension Test -->
                    <div class="tool-card">
                        <div class="tool-header">
                            <h4>üìù <span>Comprehension Test</span></h4>
                        </div>
                        <form action="http://localhost:8081/comprehension" method="post" onsubmit="handleSubmit(this, &#39;comprehension&#39;)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From Page</label>
                                    <input type="number" name="startPage" min="1" required="">
                                </div>
                                <div class="form-group">
                                    <label>To Page</label>
                                    <input type="number" name="endPage" min="1" required="">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-tool">
                                <span>Generate Test</span>
                            </button>
                        </form>
                        <div class="result-container" id="result-comprehension">
                            
                            <p class="no-result">Enter page range and click Generate Test</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>Book Assistant Lite - AI Powered</p>
        </div>
    </footer>

    <!-- Marked.js for Markdown parsing -->
    <script src="./Book Assistant Lite - AI Book Analysis_files/marked.min.js.download"></script>
    
    <!-- Highlight.js for syntax highlighting -->
    <script src="./Book Assistant Lite - AI Book Analysis_files/highlight.min.js.download"></script>
    
    <script>
        // Configure marked.js
        marked.setOptions({
            breaks: true,
            gfm: true,
            highlight: function(code, lang) {
                if (lang && hljs.getLanguage(lang)) {
                    return hljs.highlight(code, { language: lang }).value;
                }
                return hljs.highlightAuto(code).value;
            }
        });

        // Custom renderer for code blocks with copy button
        const renderer = new marked.Renderer();
        renderer.code = function(code, language) {
            const validLang = language || 'plaintext';
            const escapedCode = code.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#039;');
            
            return `
<div class="code-block-wrapper">
    <div class="code-block-header">
        <span class="code-language">${validLang}</span>
        <button class="copy-code-btn" onclick="copyCode(this)" title="Copy code">
            <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            <span class="copy-text">Copy</span>
        </button>
    </div>
    <pre class="code-block"><code class="language-${validLang}">${escapedCode}</code></pre>
</div>`;
        };

        marked.use({ renderer });

        // Copy code function
        function copyCode(button) {
            const codeBlock = button.closest('.code-block-wrapper').querySelector('code');
            const codeText = codeBlock.textContent;
            
            navigator.clipboard.writeText(codeText).then(() => {
                const copyText = button.querySelector('.copy-text');
                const originalText = copyText.textContent;
                copyText.textContent = 'Copied!';
                button.classList.add('copied');
                
                setTimeout(() => {
                    copyText.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy:', err);
            });
        }

        // Render markdown in result containers
        function renderMarkdownResults() {
            const resultContainers = document.querySelectorAll('.result-container');
            
            resultContainers.forEach(container => {
                const chatMessage = container.querySelector('.chat-message');
                if (chatMessage) {
                    const messageContent = chatMessage.querySelector('.message-content');
                    const rawContent = chatMessage.getAttribute('data-content');
                    
                    if (rawContent && messageContent) {
                        // Parse markdown and render
                        messageContent.innerHTML = marked.parse(rawContent);
                        
                        // Apply syntax highlighting to any code blocks
                        messageContent.querySelectorAll('pre code').forEach((block) => {
                            hljs.highlightElement(block);
                        });
                    }
                }
            });
        }

        // Accordion toggle function
        function toggleAccordion(group) {
            const content = document.getElementById('content-' + group);
            const arrow = document.getElementById('arrow-' + group);
            const groupEl = document.querySelector('[data-group="' + group + '"]');
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                arrow.style.transform = 'rotate(0deg)';
                groupEl.classList.remove('active');
            } else {
                content.classList.add('active');
                arrow.style.transform = 'rotate(180deg)';
                groupEl.classList.add('active');
            }
        }

        // Form submission handler
        function handleSubmit(form, resultId) {
            // Add output language hidden input
            const langSelect = document.getElementById('outputLanguage');
            if (langSelect) {
                let hiddenInput = form.querySelector('input[name="outputLanguage"]');
                if (!hiddenInput) {
                    hiddenInput = document.createElement('input');
                    hiddenInput.type = 'hidden';
                    hiddenInput.name = 'outputLanguage';
                    form.appendChild(hiddenInput);
                }
                hiddenInput.value = langSelect.value;
            }

            // Show loading state
            const button = form.querySelector('button[type="submit"]');
            const originalText = button.innerHTML;
            button.innerHTML = '<span class="spinner"></span> <span>ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©...</span>';
            button.disabled = true;
            form.classList.add('loading');

            // Reset after timeout
            setTimeout(() => {
                button.innerHTML = originalText;
                button.disabled = false;
                form.classList.remove('loading');
            }, 300000);
        }

        // Auto-expand accordion with results on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Render markdown in all result containers
            renderMarkdownResults();
            
            const results = ['summaryGeneral', 'summaryPages', 'realityCheck', 'conceptMap', 'riskFlags', 'actionPlan', 'semanticSearch', 'qa', 'comprehension'];
            
            for (let i = results.length - 1; i >= 0; i--) {
                const resultId = results[i];
                const resultEl = document.getElementById('result-' + resultId);
                if (resultEl) {
                    const chatMessage = resultEl.querySelector('.chat-message');
                    if (chatMessage) {
                        const messageContent = chatMessage.querySelector('.message-content');
                        if (messageContent && messageContent.innerHTML.trim()) {
                            // Find parent accordion group
                            const toolCard = resultEl.closest('.tool-card');
                            const accordionContent = toolCard.closest('.accordion-content');
                            const accordionGroup = accordionContent.parentElement;
                            
                            // Expand this group
                            const groupId = accordionGroup.dataset.group;
                            const content = document.getElementById('content-' + groupId);
                            const arrow = document.getElementById('arrow-' + groupId);
                            
                            content.classList.add('active');
                            arrow.style.transform = 'rotate(180deg)';
                            accordionGroup.classList.add('active');
                            
                            // Scroll to result
                            setTimeout(() => {
                                resultEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                resultEl.classList.add('highlight');
                            }, 500);
                            
                            break; // Only expand the first (most recent) result
                        }
                    }
                }
            }

            // Default: expand first accordion
            const firstAccordion = document.querySelector('.accordion-group');
            if (firstAccordion) {
                const groupId = firstAccordion.dataset.group;
                const content = document.getElementById('content-' + groupId);
                const arrow = document.getElementById('arrow-' + groupId);
                content.classList.add('active');
                arrow.style.transform = 'rotate(180deg)';
                firstAccordion.classList.add('active');
            }
        });

        // Drag and drop functionality
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');

        if (dropZone && fileInput) {
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => dropZone.classList.add('drag-over'), false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => dropZone.classList.remove('drag-over'), false);
            });

            dropZone.addEventListener('drop', (e) => {
                const dt = e.dataTransfer;
                const files = dt.files;
                if (files.length) {
                    fileInput.files = files;
                }
            });

            dropZone.addEventListener('click', () => fileInput.click());
        }
    </script>


<div><div></div></div><deepl-input-controller translate="no"><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://fancfknaplihpclbhbpclnmmjcjanbaf/build/content.css"><div dir="ltr" style="visibility: initial !important;"><div class="dl-input-translation-container svelte-95aucy"><div></div></div></div></template></deepl-input-controller></body></html>